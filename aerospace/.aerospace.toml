# =========================
# AeroSpace User Configuration
# =========================

# -------------------------
# Startup Behavior
# -------------------------
start-at-login = true                           # Launch AeroSpace automatically when macOS starts
after-login-command = []                        # Commands to execute immediately after macOS login
# after-startup-command = [                       # Commands to execute after AeroSpace fully starts
#    "exec-and-forget borders active_color=0xff7aa2f7 inactive_color=0xff1e1e2e width=4.0 style=round shadow_color=0x80000000 shadow_width=6.0"
# ]

# -------------------------
# Normalization & Layouts
# -------------------------
enable-normalization-flatten-containers = true                           # Flatten nested containers to simplify layout
enable-normalization-opposite-orientation-for-nested-containers = true   # Swap orientation for nested containers automatically

default-root-container-layout = 'tiles'                                  # Default layout of root container: tiles or accordion
default-root-container-orientation = 'auto'                              # Root container orientation: horizontal, vertical, or auto based on monitor
accordion-padding = 0                                                    # Padding between windows in accordion layout

# -------------------------
# Focus & Mouse Behavior
# -------------------------
on-focused-monitor-changed = ['move-mouse monitor-lazy-center']   # Move mouse to new monitor when focus changes
on-focus-changed = ['move-mouse window-lazy-center']               # Move mouse to focused window

automatically-unhide-macos-hidden-apps = false          # Disable automatic unhiding of apps hidden via Cmd-H

# -------------------------
# Key Mapping
# -------------------------
[key-mapping]
preset = 'qwerty'                                     # Keyboard layout preset

# -------------------------
# Window Gaps (pixels)
# -------------------------
[gaps]
# Inner gaps between windows
inner.horizontal = 8                                  # Keep horizontal spacing between windows
inner.vertical = 8                                    # Keep vertical spacing between windows

# Outer gaps between windows and screen edges                                     
outer.left = 8                                        # Space between left screen edge and windows
outer.right = 8                                       # Space between right screen edge and windows
outer.top = 0                                         # Space between top screen edge and windows
outer.bottom = 0                                      # Space between bottom screen edge and windows

# -------------------------
# Environment Variables
# -------------------------
[exec]
inherit-env-vars = true                                # Inherit system environment variables

[exec.env-vars]
PATH = '/opt/homebrew/bin:/opt/homebrew/sbin:${PATH}'  # Ensure Homebrew binaries are available

# -------------------------
# Main Mode Keybindings
# -------------------------
[mode.main.binding]

# Workspace Navigation
cmd-left = 'workspace --wrap-around prev'            # Switch to previous workspace
cmd-right = 'workspace --wrap-around next'           # Switch to next workspace
cmd-up = 'focus-monitor --wrap-around up'            # Move focus to monitor above
cmd-down = 'focus-monitor --wrap-around down'        # Move focus to monitor below

# Move workspaces across monitors
cmd-shift-left = 'move-workspace-to-monitor left'
cmd-shift-right = 'move-workspace-to-monitor right'
cmd-shift-up = 'move-workspace-to-monitor up'
cmd-shift-down = 'move-workspace-to-monitor down'

# Window Focus
cmd-h = 'focus left'                                 # Focus window to the left
cmd-j = 'focus down'                                 # Focus window below
cmd-k = 'focus up'                                   # Focus window above
cmd-l = 'focus right'                                # Focus window to the right

# Move Windows
cmd-shift-h = 'move left'                             # Move window left
cmd-shift-j = 'move down'                             # Move window down
cmd-shift-k = 'move up'                               # Move window up
cmd-shift-l = 'move right'                            # Move window right

# Resize Windows
cmd-shift-minus = 'resize smart -50'                 # Shrink window intelligently
cmd-shift-equal = 'resize smart +50'                 # Expand window intelligently

# Layout Shortcuts
cmd-slash = 'layout accordion horizontal vertical'                                                         # Toggle accordion layout
cmd-backslash = 'layout tiles horizontal vertical'                                                         # Toggle tile layout
cmd-enter = 'macos-native-fullscreen'                                                                      # Fullscreen using macOS native mode
cmd-shift-q = 'exec-and-forget osascript -e "tell application (path to frontmost application) to quit"'    # Quit Application
cmd-e = 'macos-native-minimize'                                                                            # Minimize window
cmd-m = 'fullscreen'                                                                                       # Toggle fullscreen

# Workspace shortcuts (switch to workspace 1–10)
cmd-1 = 'workspace 1'
cmd-2 = 'workspace 2'
cmd-3 = 'workspace 3'
cmd-4 = 'workspace 4'
cmd-5 = 'workspace 5'
cmd-6 = 'workspace 6'
cmd-7 = 'workspace 7'
cmd-8 = 'workspace 8'
cmd-9 = 'workspace 9'

# Move windows to specific workspaces
cmd-shift-1 = 'move-node-to-workspace 1'
cmd-shift-2 = 'move-node-to-workspace 2'
cmd-shift-3 = 'move-node-to-workspace 3'
cmd-shift-4 = 'move-node-to-workspace 4'
cmd-shift-5 = 'move-node-to-workspace 5'
cmd-shift-6 = 'move-node-to-workspace 6'
cmd-shift-7 = 'move-node-to-workspace 7'
cmd-shift-8 = 'move-node-to-workspace 8'
cmd-shift-9 = 'move-node-to-workspace 9'

# Ctrl + workspace combo: move window and switch workspace
cmd-ctrl-1 = ['move-node-to-workspace 1', 'workspace 1']
cmd-ctrl-2 = ['move-node-to-workspace 2', 'workspace 2']
cmd-ctrl-3 = ['move-node-to-workspace 3', 'workspace 3']
cmd-ctrl-4 = ['move-node-to-workspace 4', 'workspace 4']
cmd-ctrl-5 = ['move-node-to-workspace 5', 'workspace 5']
cmd-ctrl-6 = ['move-node-to-workspace 6', 'workspace 6']
cmd-ctrl-7 = ['move-node-to-workspace 7', 'workspace 7']
cmd-ctrl-8 = ['move-node-to-workspace 8', 'workspace 8']
cmd-ctrl-9 = ['move-node-to-workspace 9', 'workspace 9']

# Workspace back-and-forth
alt-tab = 'workspace-back-and-forth'                             # Toggle between current and last workspace
alt-shift-tab = 'move-workspace-to-monitor --wrap-around next'   # Move workspace to next monitor

cmd-shift-m = 'mode manage'    # Enter Manage Mode
cmd-shift-r = 'mode resize'    # Enter Resize Mode

# -------------------------
# Manage Mode Keybindings
# -------------------------
[mode.manage.binding]
esc = 'mode main'                                            # Return to main mode
enter = 'mode main'                                          # Return to main mode
c = ['reload-config', 'mode main']                           # Reload config and return to main mode
r = ['flatten-workspace-tree', 'mode main']                  # Flatten container tree and return
f = ['layout floating tiling', 'mode main']                  # Toggle floating/tiling layout
backspace = ['close-all-windows-but-current', 'mode main']   # Close all except current

# Join windows
h = ['join-with left', 'mode main']                 # Merge window to left
j = ['join-with down', 'mode main']                 # Merge window below
k = ['join-with up', 'mode main']                   # Merge window above
l = ['join-with right', 'mode main']                # Merge window to right

# -------------------------
# Resize Mode Keybindings
# -------------------------
[mode.resize.binding]
h = 'resize width -50'                               # Shrink width
l = 'resize width +50'                               # Expand width
j = 'resize height +50'                              # Expand height
k = 'resize height -50'                              # Shrink height
enter = 'mode main'                                  # Return to main mode
esc = 'mode main'                                    # Return to main mode

# -------------------------
# Application-specific Rules
# -------------------------

[[on-window-detected]]
if.app-id = 'com.brave.Browser'          # Brave browser
run = [
    'move-node-to-workspace 1',          # Place on workspace 1
    'resize smart +100'                  # Maximize / expand window
]

[[on-window-detected]]
if.app-id = 'com.apple.Safari'           # Safari browser
run = [
    'move-node-to-workspace 2',          # Place on workspace 2
    'resize smart +100'                  # Maximize / expand window
]

[[on-window-detected]]
if.app-id = 'com.bitwarden.desktop'      # Bitwarden app
run = ['layout floating']                # Always floating

[[on-window-detected]]
if.app-id = 'com.apple.finder'           # Finder
run = ['layout floating']                # Always floating

[[on-window-detected]]
if.app-id = 'com.mitchellh.ghostty'      # Ghostty terminal
run = ['move-node-to-workspace 1']       # Open in workspace 1

# -------------------------
# Workspace to Monitor Assignment
# -------------------------
[workspace-to-monitor-force-assignment]
1 = 1                                                 # Workspace 1 → Monitor 1
2 = 2                                                 # Workspace 2 → Monitor 2
3 = 2                                                 # Workspace 3 → Monitor 2
4 = 2                                                 # Workspace 4 → Monitor 2
5 = 2                                                 # Workspace 5 → Monitor 2
6 = 2                                                 # Workspace 6 → Monitor 2
7 = 1                                                 # Workspace 7 → Monitor 1
8 = 1                                                 # Workspace 8 → Monitor 1
9 = 2                                                 # Workspace 9 → Monitor 2
